{"name":"Bsseeker2","tagline":"A versatile aligning pipeline for bisulfite sequencing data","body":"BS-Seeker2\r\n=========\r\n[Homepage](http://pellegrini.mcdb.ucla.edu/BS_Seeker2/) | [Published Paper](http://www.biomedcentral.com/1471-2164/14/774) |\r\n[Source code](https://github.com/BSSeeker/BSseeker2) |\r\n[Galaxy Toolshed](http://toolshed.g2.bx.psu.edu/repository?repository_id=e435334e4e9e19c1) |\r\n[UCLA Galaxy](http://galaxy.hoffman2.idre.ucla.edu)\r\n\r\nBS Seeker 2 is a seamless and versatile pipeline for accurately and fast mapping the bisulfite-treated short reads.\r\n\r\n1. Remarkable new features\r\n============\r\n\r\n* Reduced index for RRBS, accelerating the mapping speed and increasing mappability\r\n* Allowing local/gapped alignment with Bowtie 2, increased the mappability\r\n* Option for removing reads suffering from bisulfite conversion failure\r\n\r\n2. Supports\r\n============\r\n\r\n* Supported library types\r\n\t- Whole Genome-wide Bisulfite Sequencing (WGBS)\r\n\t- Reduced Representative Bisulfite Sequencing (RRBS)\r\n\r\n* Supported formats for input file\r\n\t- [fasta](http://en.wikipedia.org/wiki/FASTA_format)\r\n\t- [fastq](http://en.wikipedia.org/wiki/FASTQ_format)\r\n\t- [qseq](http://jumpgate.caltech.edu/wiki/QSeq)\r\n\t- pure sequence (one-line one-sequence)\r\n\r\n* Supported alignment tools\r\n\t- [bowtie](http://bowtie-bio.sourceforge.net/index.shtml) : Single-seed, fast, (default)\r\n\t- [bowtie2](http://bowtie-bio.sourceforge.net/bowtie2/index.shtml) : Multiple-seed, gapped-alignment\r\n\t\t- [local alignment](http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#local-alignment-example) (default for bowtie2)\r\n\t\t- [end-to-end alignment](http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#end-to-end-alignment-example)\r\n\t- [soap](http://soap.genomics.org.cn/)\r\n\r\n* Supported formats for mapping results\r\n\t- [BAM](http://genome.ucsc.edu/FAQ/FAQformat.html#format5.1)\r\n\t- [SAM](http://samtools.sourceforge.net/)\r\n\t- [BS-seeker](http://pellegrini.mcdb.ucla.edu/BS_Seeker/USAGE.html)\r\n\r\n3. System requirements\r\n============\r\n\r\n* Linux/Unix or Mac OS platform\r\n\r\n* One of the following short read aligners\r\n\r\n  [bowtie](http://bowtie-bio.sourceforge.net/), [bowtie2](http://bowtie-bio.sourceforge.net/bowtie2/), [soap](http://soap.genomics.org.cn/)\r\n\r\n* [Python](http://www.python.org/download/) (Version 2.6 +)\r\n\r\n  It is normally pre-installed in Linux. Type \" python -V\" to see the installed version.\r\n\r\n* [pysam](http://code.google.com/p/pysam/) package (Version 0.6+).\r\n\r\n  Read \"Questions & Answers\" if you have problem when installing this package.\r\n\r\n4. Modules' descriptions\r\n============\r\n\r\n(0) FilterReads.py\r\n------------\r\n\r\nOptional and independent module.\r\nSome reads would be extremely amplified during the PCR. This script helps you get unique reads before doing the mapping.\r\nYou can decide whether or not to filter reads before doing the mapping.\r\n\r\n####Usage :\r\n\r\n\t$ python FilterReads.py\r\n\tUsage: FilterReads.py -i <input> -o <output> [-k]\r\n\tAuthor : Guo, Weilong; 2012-11-10\r\n\tUnique reads for qseq/fastq/fasta/sequencce, and filter\r\n\tlow quality file in qseq file.\r\n\r\n\tOptions:\r\n\t  -h, --help  show this help message and exit\r\n\t  -i FILE     Name of the input qseq/fastq/fasta/sequence file\r\n\t  -o FILE     Name of the output file\r\n\t  -k          Would not filter low quality reads if specified\r\n\r\n\r\n####Tip :\r\n\r\n- This step is not suggested for RRBS library, as reads from RRBS library would more likely from the same location.\r\n\r\n\r\n(1) bs_seeker2-build.py\r\n------------\r\n\r\nModule to build the index for BS-Seeker2.\r\n\r\n\r\n####Usage :\r\n\r\n    $ python bs_seeker2-build.py -h\r\n    Usage: bs_seeker2-build.py [options]\r\n\r\n    Options:\r\n      -h, --help            show this help message and exit\r\n      -f FILE, --file=FILE  Input your reference genome file (fasta)\r\n      --aligner=ALIGNER     Aligner program to perform the analysis: bowtie,\r\n                            bowtie2, soap, rmap [Default: bowtie]\r\n      -p PATH, --path=PATH  Path to the aligner program. Detected:\r\n                            bowtie: ~/install/bowtie\r\n                            bowtie2: ~/install/bowtie2\r\n                            rmap: ~/install/rmap_/bin\r\n                            soap: ~/install/soap/\r\n      -d DBPATH, --db=DBPATH\r\n                            Path to the reference genome library (generated in\r\n                            preprocessing genome) [Default: ~/install\r\n                            /BSseeker2/bs_utils/reference_genomes]\r\n      -v, --version         show version of BS-Seeker2\r\n\r\n      Reduced Representation Bisulfite Sequencing Options:\r\n        Use this options with conjuction of -r [--rrbs]\r\n\r\n        -r, --rrbs          Build index specially for Reduced Representation\r\n                            Bisulfite Sequencing experiments. Genome other than\r\n                            certain fragments will be masked. [Default: False]\r\n        -l LOW_BOUND, --low=LOW_BOUND\r\n                            lower bound of fragment length (excluding recognition\r\n                            sequence such as C-CGG) [Default: 20]\r\n        -u UP_BOUND, --up=UP_BOUND\r\n                            upper bound of fragment length (excluding recognition\r\n                            sequence such as C-CGG ends) [Default: 500]\r\n        -c CUT_FORMAT, --cut-site=CUT_FORMAT\r\n                            Cut sites of restriction enzyme. Ex: MspI(C-CGG),\r\n                            Mael:(C-TAG), double-enzyme MspI&Mael:(C-CGG,C-TAG).\r\n                            [Default: C-CGG]\r\n\r\n\r\n####Example\r\n\r\n* Build genome index for WGBS using bowtie, path of bowtie should be included in $PATH\r\n\r\n        python bs_seeker2-build.py -f genome.fa --aligner=bowtie\r\n\r\n* Build genome index for RRBS with default parameters specifying the path for bowtie2\r\n\r\n        python bs_seeker2-build.py -f genome.fa --aligner=bowtie2 -p ~/install/bowtie2-2.0.0-beta7/ -r\r\n\r\n* Build genome index for RRBS library using bowite2, with fragment lengths ranging [40bp, 400bp]\r\n\r\n        python bs_seeker2-build.py -f genome.fa -r -l 40 -u 400 --aligner=bowtie2\r\n\r\n* Build genome index for RRBS library for double-enzyme : MspI (C-CGG) & ApeKI (G-CWGC, where W=A|T, see [IUPAC code](http://www.bioinformatics.org/sms/iupac.html))\r\n\r\n        python bs_seeker2-build.py -f genome.fa -r -c C-CGG,G-CWGC --aligner=bowtie\r\n\r\n####Tips:\r\n\r\n- Index built for BS-Seeker2 is different from the index for BS-Seeker 1.\r\nFor RRBS, you need to specify \"-r\" in the parameters. Also, you need to specify LOW_BOUND and UP_BOUND for the range of fragment lengths according your protocol.\r\n\r\n- The fragment length is different from read length. Fragments refers to the DNA fragments which you get by size-selection step (i.e. gel-cut oor AMPure beads). Lengths of fragments are supposed to be in a range, such as [50bp,250bp].\r\n\r\n- The indexes for RRBS and WGBS are different. Also, indexes for RRBS are specific for fragment length parameters (LOW_BOUND and UP_BOUND).\r\n\r\n\r\n\r\n\r\n(2) bs_seeker2-align.py\r\n------------\r\n\r\nModule to map reads on 3-letter converted genome.\r\n\r\n####Usage :\r\n\r\n    $ python ~/install/BSseeker2/bs_seeker2-align.py -h\r\n    Usage: bs_seeker2-align.py {-i <single> | -1 <mate1> -2 <mate2>} -g <genome.fa> [options]\r\n\r\n    Options:\r\n      -h, --help            show this help message and exit\r\n\r\n      For single end reads:\r\n        -i INFILE, --input=INFILE\r\n                            Input read file (FORMAT: sequences, qseq, fasta,\r\n                            fastq). Ex: read.fa or read.fa.gz\r\n\r\n      For pair end reads:\r\n        -1 FILE, --input_1=FILE\r\n                            Input read file, mate 1 (FORMAT: sequences, qseq,\r\n                            fasta, fastq)\r\n        -2 FILE, --input_2=FILE\r\n                            Input read file, mate 2 (FORMAT: sequences, qseq,\r\n                            fasta, fastq)\r\n        -I MIN_INSERT_SIZE, --minins=MIN_INSERT_SIZE\r\n                            The minimum insert size for valid paired-end\r\n                            alignments [Default: 0]\r\n        -X MAX_INSERT_SIZE, --maxins=MAX_INSERT_SIZE\r\n                            The maximum insert size for valid paired-end\r\n                            alignments [Default: 500]\r\n\r\n      Reduced Representation Bisulfite Sequencing Options:\r\n        -r, --rrbs          Map reads to the Reduced Representation genome\r\n        -c pattern, --cut-site=pattern\r\n                            Cutting sites of restriction enzyme. Ex: MspI(C-CGG),\r\n                            Mael:(C-TAG), double-enzyme MspI&Mael:(C-CGG,C-TAG).\r\n                            [Default: C-CGG]\r\n        -L RRBS_LOW_BOUND, --low=RRBS_LOW_BOUND\r\n                            Lower bound of fragment length (excluding C-CGG ends)\r\n                            [Default: 20]\r\n        -U RRBS_UP_BOUND, --up=RRBS_UP_BOUND\r\n                            Upper bound of fragment length (excluding C-CGG ends)\r\n                            [Default: 500]\r\n\r\n      General options:\r\n        -t TAG, --tag=TAG   [Y]es for undirectional lib, [N]o for directional\r\n                            [Default: N]\r\n        -s CUTNUMBER1, --start_base=CUTNUMBER1\r\n                            The first cycle of the read to be mapped [Default: 1]\r\n        -e CUTNUMBER2, --end_base=CUTNUMBER2\r\n                            The last cycle of the read to be mapped [Default: 200]\r\n        -a FILE, --adapter=FILE\r\n                            Input text file of your adaptor sequences (to be\r\n                            trimmed from the 3'end of the reads, ). Input one seq\r\n                            for dir. lib., twon seqs for undir. lib. One line per\r\n                            sequence. Only the first 10bp will be used\r\n        --am=ADAPTER_MISMATCH\r\n                            Number of mismatches allowed in adapter [Default: 0]\r\n        -g GENOME, --genome=GENOME\r\n                            Name of the reference genome (should be the same as\r\n                            \"-f\" in bs_seeker2-build.py ) [ex. chr21_hg18.fa]\r\n        -m NO_MISMATCHES, --mismatches=NO_MISMATCHES\r\n                            Number of mismatches in one read [Default: 4]\r\n        --aligner=ALIGNER   Aligner program for short reads mapping: bowtie,\r\n                            bowtie2, soap, rmap [Default: bowtie]\r\n        -p PATH, --path=PATH\r\n                            Path to the aligner program. Detected:\r\n                            bowtie: ~/install/bowtie\r\n                            bowtie2: ~/install/bowtie2\r\n                            rmap: ~/install/rmap/bin\r\n                            soap: ~/install/soap/\r\n        -d DBPATH, --db=DBPATH\r\n                            Path to the reference genome library (generated in\r\n                            preprocessing genome) [Default: ~/i\r\n                            nstall/BSseeker2/bs_utils/reference_genomes]\r\n        -l NO_SPLIT, --split_line=NO_SPLIT\r\n                            Number of lines per split (the read file will be split\r\n                            into small files for mapping. The result will be\r\n                            merged. [Default: 4000000]\r\n        -o OUTFILE, --output=OUTFILE\r\n                            The name of output file [INFILE.bs(se|pe|rrbs)]\r\n        -f FORMAT, --output-format=FORMAT\r\n                            Output format: bam, sam, bs_seeker1 [Default: bam]\r\n        --no-header         Suppress SAM header lines [Default: False]\r\n        --temp_dir=PATH     The path to your temporary directory [Detected: /tmp]\r\n        --XS=XS_FILTER      Filter definition for tag XS, format X,Y. X=0.8 and\r\n                            y=5 indicate that for one read, if #(mCH sites)/#(all\r\n                            CH sites)>0.8 and #(mCH sites)>5, then tag XS=1; or\r\n                            else tag XS=0. [Default: 0.5,5]\r\n        --multiple-hit      Output reads with multiple hits to\r\n                            file\"Multiple_hit.fa\"\r\n        -v, --version       show version of BS-Seeker2\r\n\r\n      Aligner Options:\r\n        You may specify any additional options for the aligner. You just have\r\n        to prefix them with --bt- for bowtie, --bt2- for bowtie2, --soap- for\r\n        soap, --rmap- for rmap, and BS Seeker will pass them on. For example:\r\n        --bt-p 4 will increase the number of threads for bowtie to 4, --bt--\r\n        tryhard will instruct bowtie to try as hard as possible to find valid\r\n        alignments when they exist, and so on. Be sure that you know what you\r\n        are doing when using these options! Also, we don't do any validation\r\n        on the values.\r\n\r\n\r\n####Examples :\r\n\r\n* WGBS library ; alignment mode, bowtie ; map to WGBS index\r\n\r\n        python bs_seeker2-align.py -i WGBS.fa --aligner=bowtie -o WGBS.bam -f bam -g genome.fa\r\n\r\n* WGBS library ; alignment mode, bowtie2-local ; map to WGBS index\r\n\r\n        python bs_seeker2-align.py -i WGBS.fa --aligner=bowtie2 -o WGBS.bam -f bam -g genome.fa\r\n\r\n* WGBS library ; alignment mode, bowtie2-end-to-end ; map to WGBS index\r\n\r\n        python bs_seeker2-align.py -i WGBS.fa -m 3 --aligner=bowtie2 -o WGBS.bam -f bam -g genome.fa --bt2--end-to-end\r\n\r\n* RRBS library ; alignment mode, bowtie ; map to RR index\r\n\r\n        python bs_seeker2-align.py -i RRBS.fa --aligner=bowtie -o RRBS.bam -g genome.fa -r -a adapter.txt\r\n\r\n* RRBS library ; alignment mode, bowtie ; map to WG index\r\n\r\n        python bs_seeker2-align.py -i RRBS.fa --aligner=bowtie -o RRBS.bam -g genome.fa -a adapter.txt\r\n\r\n* RRBS library ; alignment mode, bowtie2-end-to-end ; map to WG index\r\n\r\n        python bs_seeker2-align.py -i RRBS.fa --aligner=bowtie -o RRBS.bam -g genome.fa -a adapter.txt --bt2--end-to-end\r\n\r\n* Align from qseq format for RRBS with bowtie, specifying lengths of fragments ranging [40bp, 400bp]\r\n\r\n        python bs_seeker2-align.py -i RRBS.qseq --aligner=bowtie -o RRBS.bam -f bam -g genome.fa -r --low=40 --up=400 -a adapter.txt\r\n\r\nThe parameters '--low' and '--up' should be the same with corresponding parameters when building the genome index\r\n\r\n* WGBS library ; alignment mode, bowtie ; map to WGBS index; use 8 threads for alignment\r\n\r\n        python bs_seeker2-align.py -i WGBS.fa --aligner=bowtie -o WGBS.bam -f bam -g genome.fa --bt-p 4\r\n\r\nBS-Seeker2 will run TWO bowtie instances in parallel.\r\n\r\n\r\n####Input file:\r\n\r\n- Adapter.txt (example for single-end WGBS / RRBS) :\r\n\r\n            AGATCGGAAGAGCACACGTC\r\n\r\n- Adapter.txt (example for paired-end WGBS) :\r\n\r\n            <adapter for mate 1>\r\n            <adapter for mate 2>\r\n\r\n\r\n####Output files:\r\n\r\n- SAM file\r\n\r\n    Sample:\r\n\r\n        10918   0       chr1    133859922       255     100M    *       0       0       TGGTTGTTTTTGTTATAGTTTTTTGTTGTAGAGTTTTTTTTGGAAAGTTGTGTTTATTTTTTTTTTTGTTTGGGTTTTGTTTGAAAGGGGTGGATGAGTT        *       XO:Z:+FW        XS:i:0  NM:i:3  XM:Z:x--yx-zzzy--y--y--zz-zyx-yx-y--------z------------x--------z--zzz----y----y--x-zyx--------y--------z   XG:Z:-C_CGGCCGCCCCTGCTGCAGCCTCCCGCCGCAGAGTTTTCTTTGGAAAGTTGCGTTTATTTCTTCCCTTGTCTGGGCTGCGCCCGAAAGGGGCAGATGAGTC_AC\r\n\r\n\r\n    Format descriptions:\r\n\r\n        BS-Seeker2 specific tags:\r\n        XO : orientation, from forward/reverted\r\n        XS : 1 when read is recognized as not fully converted by bisulfite treatment, or else 0\r\n        XM : number of sites for mismatch\r\n                X: methylated CG\r\n                x: un-methylated CG\r\n                Y: methylated CHG\r\n                y: un-methylated CHG\r\n                Z: methylated CHH\r\n                z: un-methylated CHH\r\n        XG : genome sequences, with 2bp extended on both ends, from 5' to 3'\r\n        YR : tag only for RRBS, serial id of mapped fragment\r\n        YS : tag only for RRBS, start position of mapped fragment\r\n        YE : tag only for RRBS, end position of mapped fragment\r\n\r\n        Note:\r\n            For reads mapped on Watson(minus) strand, the 10th colum in SAM file is not the original reads but the revered sequences.\r\n\r\n\r\n####Tips:\r\n\r\n- Removing adapter is recommended.\r\n\r\n\tIf you don't know what's your parameter, please ask the person who generate the library for you.\r\n\r\n\tIf you are too shy to ask for it, you can try to de novo motif finding tools (such as [DME](http://cb1.utdallas.edu/dme/index.htm) and [MEME](http://meme.nbcr.net/meme/cgi-bin/meme.cgi)) find the enriched pattern in 1000 reads.\r\n\r\n\tOf course, you can also use other tools (such as [cutadapt](http://code.google.com/p/cutadapt/) ) to remove adaptor first.\r\n\r\n- It's always better to use a wider range for fragment length.\r\n\r\n\tFor example, if 95% of reads come from fragments with length range [50bp, 250bp], you'd better choose [40bp, 300bp].\r\n\r\n- Fewer mismatches for the 'local alignment' mode.\r\n\r\n    As the 'local alignment', the bad sequenced bases are usually trimmed, and would not be considered by the parameter \"-m\".\r\n    It is suggested to user fewer mismatches for the 'local alignment' mode.\r\n\r\n(3) bs_seeker2-call_methylation.py\r\n------------\r\n\r\n\r\nThis module calls methylation levels from the mapping result.\r\n\r\n####Usage:\r\n\r\n        $ python bs_seeker2-call_methylation.py -h\r\n        Options:\r\n          -h, --help            show this help message and exit\r\n          -i INFILE, --input=INFILE\r\n                                BAM output from bs_seeker2-align.py\r\n          -d DBPATH, --db=DBPATH\r\n                                Path to the reference genome library (generated in\r\n                                preprocessing genome) [Default: ~/install\r\n                                /BSseeker2/bs_utils/reference_genomes]\r\n          -o OUTFILE, --output-prefix=OUTFILE\r\n                                The output prefix to create ATCGmap and wiggle files\r\n                                [INFILE]\r\n          --wig=OUTFILE         The output .wig file [INFILE.wig]\r\n          --CGmap=OUTFILE       The output .CGmap file [INFILE.CGmap]\r\n          --ATCGmap=OUTFILE     The output .ATCGmap file [INFILE.ATCGmap]\r\n          -x, --rm-SX           Removed reads with tag 'XS:i:1', which would be\r\n                                considered as not fully converted by bisulfite\r\n                                treatment [Default: False]\r\n          --txt                 Show CGmap and ATCGmap in .gz [Default: False]\r\n          -r READ_NO, --read-no=READ_NO\r\n                                The least number of reads covering one site to be\r\n                                shown in wig file [Default: 1]\r\n          -v, --version         show version of BS-Seeker2\r\n\r\n\r\n####Example :\r\n\r\n-For WGBS (whole genome bisulfite sequencing):\r\n\r\n        python bs_seeker2-call_methylation.py -i WGBS.bam -o output --db <BSseeker2_path>/bs_utils/reference_genomes/genome.fa_bowtie/\r\n\r\n-For RRBS:\r\n\r\n        python bs_seeker2-call_methylation.py -i RRBS.bam -o output --db <BSseeker2_path>/bs_utils/reference_genomes/genome.fa_rrbs_40_400_bowtie2/\r\n\r\n-For RRBS and removed un-converted reads (with tag XS=1):\r\n\r\n        python bs_seeker2-call_methylation.py -x -i RRBS.bam -o output --db <BSseeker2_path>/bs_utils/reference_genomes/genome.fa_rrbs_75_280_bowtie2/\r\n\r\n-For RRBS and only show sites covered by at least 10 reads in WIG file:\r\n\r\n        python bs_seeker2-call_methylation.py -r 10 -i RRBS.bam -o output --db <BSseeker2_path>/bs_utils/reference_genomes/genome.fa_rrbs_75_280_bowtie2/\r\n\r\n\r\nThe folder “genome.fa\\_rrbs\\_40\\_500\\_bowtie2” is built  in the first step\r\n\r\n####Output files:\r\n\r\n- wig file\r\n\r\n    Sample:\r\n\r\n        variableStep chrom=chr1\r\n        3000419\t0.000000\r\n        3000423\t-0.2\r\n        3000440\t0.000000\r\n        3000588\t0.5\r\n        3000593\t-0.000000\r\n\r\n\r\n        Format descriptions:\r\n        WIG file format. Negative value for 2nd column indicate a Cytosine on minus strand.\r\n\r\n\r\n- CGmap file\r\n\r\n    Sample:\r\n\r\n        chr1\tG\t3000851\tCHH\tCC\t0.1\t1\t10\r\n        chr1\tC\t3001624\tCHG\tCA\t0.0\t0\t9\r\n        chr1\tC\t3001631\tCG\tCG\t1.0\t5\t5\r\n\r\n    Format descriptions:\r\n\r\n        (1) chromosome\r\n        (2) nucleotide on Watson (+) strand\r\n        (3) position\r\n        (4) context (CG/CHG/CHH)\r\n        (5) dinucleotide-context (CA/CC/CG/CT)\r\n        (6) methylation-level = #_of_C / (#_of_C + #_of_T).\r\n        (7) #_of_C (methylated C, the count of reads showing C here)\r\n        (8) = #_of_C + #_of_T (all Cytosines, the count of reads showing C or T here)\r\n\r\n\r\n- ATCGmap file\r\n\r\n    Sample:\r\n\r\n        chr1\tT\t3009410\t--\t--\t0\t10\t0\t0\t0\t0\t0\t0\t0\t0\tna\r\n        chr1\tC\t3009411\tCHH\tCC\t0\t10\t0\t0\t0\t0\t0\t0\t0\t0\t0.0\r\n        chr1\tC\t3009412\tCHG\tCC\t0\t10\t0\t0\t0\t0\t0\t0\t0\t0\t0.0\r\n        chr1\tC\t3009413\tCG\tCG\t0\t10\t50\t0\t0\t0\t0\t0\t0\t0\t0.83\r\n\r\n\r\n    Format descriptions:\r\n\r\n        (1) chromosome\r\n        (2) nucleotide on Watson (+) strand\r\n        (3) position\r\n        (4) context (CG/CHG/CHH)\r\n        (5) dinucleotide-context (CA/CC/CG/CT)\r\n\r\n        (6) - (10) plus strand\r\n        (6) # of reads from Watson strand mapped here, support A on Watson strand\r\n        (7) # of reads from Watson strand mapped here, support T on Watson strand\r\n        (8) # of reads from Watson strand mapped here, support C on Watson strand\r\n        (9) # of reads from Watson strand mapped here, support G on Watson strand\r\n        (10) # of reads from Watson strand mapped here, support N\r\n\r\n        (11) - (15) minus strand\r\n        (11) # of reads from Crick strand mapped here, support A on Watson strand and T on Crick strand\r\n        (12) # of reads from Crick strand mapped here, support T on Watson strand and A on Crick strand\r\n        (13) # of reads from Crick strand mapped here, support C on Watson strand and G on Crick strand\r\n        (14) # of reads from Crick strand mapped here, support G on Watson strand and C on Crick strand\r\n        (15) # of reads from Crick strand mapped here, support N\r\n\r\n        (16) methylation_level = #C/(#C+#T) = C8/(C7+C8) for Watson strand, =C14/(C11+C14) for Crick strand;\r\n        \"nan\" means none reads support C/T at this position.\r\n\r\n\r\n\r\nContact Information\r\n============\r\n\r\nIf you still have questions on BS-Seeker 2, or you find bugs when using BS-Seeker 2, or you have suggestions, please write email to [Weilong Guo](guoweilong@gmail.com).\r\n\r\n\r\n\r\nQuestions & Answers\r\n============\r\n\r\n\r\n\r\n###(1) Performance\r\n\r\n####QA1.1\r\n\r\nQ: \"It takes me days to do the alignment for one lane\" ... (Speed-up your alignment)\r\n\r\nA: Yes, alignment is a time-consuming work, especially because the sequencing depth is increasing. An efficient way to align is :\r\n\r\n    i. cut the original sequence file into multiple small pieces;\r\n\r\n        Ex: split -l 4000000 input.fq\r\n\r\n    ii. align them in parallel;\r\n    iii. merge all the BAM files into a single one before running \"bs-seeker2_call-methylation.py\" (user \"samtools merge\" command).\r\n\r\n        Ex: samtools merge out.bam in1.bam in2.bam in3.bam\r\n\r\n####QA1.2\r\n\r\nQ: \"I would run lots of BS-Seeker2 at the same time on cluster (multiple nodes), how could I reduce the disk load?\"\r\n\r\nA: For bowtie/bowtie2, you can specify the parameter \"--bt--mm\"/\"--bt2--mm\" to use the memory-mapped I/O.\r\n\r\n####QA1.3\r\n\r\nQ: \"How could I specify more threads/CPU\"?\r\n\r\nA: By default, BS-Seeker2 will create two bowtie/bowtie2 processes for directional library (four for un-directional library),\r\n and each process would run with 2 threads. User can change the number of total threads using parameter \"--bt-p\"/\"--bt2-p\". For example,\r\n \"--bt-p 4\" will require 8 CPUs in total.\r\n\r\n###(2)  Input/Output formats\r\n\r\n####QA2.1\r\n\r\nQ: Is the read sequence in BAM/SAM file is the same as my original one?\r\n\r\nA: NO. They are different for several reasons.\r\n\r\n    i. For RRBS, some reads are short because of trimming of the adapters\r\n    ii. For read mapping on Crick (-) strand, the reads are in fact the complementary of the original sequence, opposite both in nucleotides and direction\r\n\r\n####QA2.2\r\n\r\nQ: In CGmap files, why some lines shown \"--\" but not a motif (CG/CHG/CHH), for example:\r\n\r\n    chr01   C       4303711 --      CC      0.0     0       2\r\n    chr01   C       4303712 --      CN      0.0     0       2\r\n\r\nA: In this example, the site 4303713 is \"N\" in genome, thus we could not decide the explict pattern.\r\n\r\n\r\n####QA2.3\r\n\r\nQ: Can BS Seeker 2 accept gzipped INPUT files?\r\n\r\nA: From v2.0.5, BS-Seeker2 is able to support input file in gzipped format, with file name end in \".gz\".\r\n\r\n####QA2.4\r\n\r\nQ: Each of my CGmap files has between 1,000 and 2,000 positions at which the nucleotide is given without a motif, but\r\ninstead just \"--\" for example:\r\n\r\n        chr01   C       4303711 --      CC      0.0     0       2\r\n        chr01   C       4303712 --      CN      0.0     0       2\r\n\r\nA: That's because chr1:4303713 on reference genome is 'N'. BS-Seeker2 can not tell it as \"CHG\" or \"CHH\".\r\n\r\n\r\n###(3) \"Pysam\" package related problem\r\n\r\n####QA3.1\r\n\r\nQ: I'm normal account user for Linux(Cluster). I can't install \"pysam\". I get following error massages:\r\n\r\n\r\n        $ python setup.py install\r\n        running install\r\n        error: can't create or remove files in install directory\r\n        The following error occurred while trying to add or remove files in the\r\n        installation directory:\r\n            [Errno 13] Permission denied: '/usr/lib64/python2.6/site-packages/test-easy-install-26802.write-test'\r\n        ...\r\n\r\n\r\nA: You can ask the administrator of your cluster to install pysam. If you don't want to bother him/her, you might need to build your own python, and then install the \"pysam\" package. The following script could be helpful for you.\r\n\r\n\r\n        mkdir ~/install\r\n        cd ~/install/\r\n\r\n        # install python\r\n        wget http://www.python.org/ftp/python/2.7.4/Python-2.7.4.tgz # download the python from websites\r\n        tar zxvf Python-2.7.4.tgz # decompress\r\n        cd Python-2.7.4\r\n        ./configure --prefix=`pwd`\r\n        make\r\n        make install\r\n\r\n        # Add the path of Python to $PATH\r\n        #  Please add the following line to file ~/.bashrc\r\n\r\n            export PATH=~/install/Python-2.7.4:$PATH\r\n\r\n        # save the ~/.bashrc file\r\n        source ~/.bashrc\r\n\r\n        # install pysam package\r\n        wget https://pysam.googlecode.com/files/pysam-0.7.4.tar.gz\r\n        tar zxvf pysam-0.7.4.tar.gz\r\n        cd pysam-0.7.4\r\n        python setup.py build\r\n        python setup.py install\r\n        # re-login the shell after finish installing pysam\r\n\r\n        # install BS-Seeker2\r\n        wget https://github.com/BSSeeker/BSseeker2/archive/master.zip\r\n        mv master BSSeeker2.zip\r\n        unzip BSSeeker2.zip\r\n        cd BSseeker2-master/\r\n\r\n####QA3.2\r\n\r\nQ: I came up with the errors\r\n\r\n        Traceback (most recent call last):\r\n          File \"bs_seeker2-align.py\", line 390, in <module>\r\n            options.Output_multiple_hit\r\n          File \"bs_align/bs_pair_end.py\", line 904, in bs_pair_end\r\n            output_genome = output_genome_1, rnext = mapped_chr, pnext = mapped_location_2)\r\n          File \"bs_align/output.py\", line 112, in store2\r\n            a.rnext = rnext if rnext == -1 else self.chrom_ids[rnext]\r\n        AttributeError: 'csamtools.AlignedRead' object has no attribute 'rnext'\r\n\r\nA: Your pysam seems out of date. I would use pysam version 0.6+.\r\n\r\n####QA3.3\r\n\r\nQ: I came up with the following error:\r\n\r\n        Traceback (most recent call last):\r\n          File \"BSseeker2/bs_seeker2-align.py\", line 279, in <module>\r\n            options.Output_multiple_hit\r\n          File \"BSseeker2/bs_align/bs_rrbs.py\", line 210, in bs_rrbs\r\n            seq=l[8]\r\n        IndexError: list index out of range\r\n\r\nA: It is very likely that your input file is in a wrong format.\r\n\r\n\r\n####QA3.4\r\n\r\nQ: When running bs_seeker2-call_methylation.py with -x option, an error occurred as following:\r\n\r\n        Traceback (most recent call last):\r\n          File \"/BSseeker2/bs_seeker2-call_methylation.py\", line 144, in <module>\r\n            if ( (options.RM_SX) and (dict(pr.alignment.tags)[\"XS\"] == 1) ):\r\n          File \"csamtools.pyx\", line 2530, in csamtools.AlignedRead.tags.__get__ (pysam/csamtools.c:22827)\r\n        OverflowError: unsigned byte integer is less than minimum\r\n\r\nA: This error is related with pysam version. Testing using pysam v0.6.x would not have such error. People reports such\r\nerror when using pysam v0.7.4. We haven't test other pysam versions, and are very glad if you could tell us whether\r\nit works on other versions.\r\n\r\n\r\n####QA3.5\r\n\r\nQ: What's my pysam version?\r\n\r\nA: Open python interpreter, and enter the following commands:\r\n\r\n        >>import pysam\r\n        >>pysam.__version__\r\n\r\n\r\n###(4) Configuration of BS-Seeker2\r\n\r\n####QA4.1\r\n\r\nQ: Can I add the path of BS-Seeker2's *.py to the $PATH, so I can call\r\nBS-Seeker2 from anywhere?\r\n\r\nA: If you're using the \"python\" from path \"/usr/bin/python\", you can directly\r\nadd the path of BS-Seeker2 in file \"~/.bash_profile\" (bash) or \"~/.profile\"\r\n(other shell) or \"~/.bashrc\" (per-interactive-shell startup).\r\nBut if you are using python under other directories, you might need to modify\r\nBS-Seeker2's script first. For example, if your python path is \"/my_python/python\",\r\nplease change the first line in \"bs_seeker-build.py\", \"bs_seeker-align.py\" and\r\n\"bs_seeker-call_methylation.py\" to\r\n\r\n        #!/my_python/python\r\n\r\nThen add\r\n\r\n        export PATH=/path/to/BS-Seeker2/:$PATH\r\n\r\nto file \"~/.bash_profile\" (e.g.), and source the file:\r\n\r\n        source  ~/.bash_profile\r\n\r\nThen you can use BS-Seeker2 globally by typing:\r\n\r\n        bs_seeker_build.py -h\r\n        bs_seeker-align.py -h\r\n        bs_seeker-call_methylation.py -h\r\n\r\n\r\n\r\n####QA4.2\r\n\r\nQ: I used the following command:\r\n\r\n        python bs_seeker2-align.py -i input.fastq -g genome.fa --aligner=bowtie2 -o output.txt\r\n\r\nHowever, I receive the following error:\r\n\r\n        Traceback (most recent call last):\r\n          File \"bs_seeker2-align.py\", line 336, in <module>\r\n            options.Output_multiple_hit\r\n          File \"bs_align/bs_single_end.py\", line 280, in bs_single_end\r\n            'output_file' : CG2A} ])\r\n          File \"bs_utils/utils.py\", line 332, in run_in_parallel\r\n            for i, proc in enumerate([subprocess.Popen(args = shlex.split(cmd), stdout = stdout) for cmd, stdout in commands]):\r\n          File \"Python-2.6.9/Lib/subprocess.py\", line 623, in __init__\r\n            errread, errwrite)\r\n          File \"Python-2.6.9/Lib/subprocess.py\", line 1141, in _execute_child\r\n            raise child_exception\r\n        OSError: [Errno 2] No such file or directory\r\n\r\nA: This error message indicate that you haven't install bowtie2, or you haven't made bowtie2 been included in $PATH.\r\n\r\n\r\n###(5) Unique alignment\r\n\r\n####QA5.1\r\n\r\nQ: If I want to only keep alignments that map uniquely, is this an argument I should supply directly\r\nto Bowtie2 (via BS Seeker 2's command line option), or is this an option that's available in\r\nBS Seeker 2 itself?\r\n\r\nA: BS-Seeker2 reports unique alignment by default already. If you want to know how many reads\r\ncould have multiple hits, run BS-Seeker2 with parameter \"--multiple-hit\".\r\n\r\n\r\n###(6) Paired-end sequencing alignment\r\n\r\n####QA6.1\r\n\r\nQ: What should I do if the two mates have overlaps? Ex: fragment length=150bp, two mates are in length of 100bp\r\n\r\nA: I suggest a pre-step for merging two overlapped reads into one. Such tools include\r\n[SeqPrep](https://github.com/jstjohn/SeqPrep), [Stitch](https://github.com/sstephenson/stitch), etc.\r\n\r\n\r\n###(7) Adapter related issue\r\n\r\n####QA7.1\r\n\r\nQ: What's the algorithm to remove the adapter?\r\n\r\nA: BS-Seeker2 has built-in algorithm for removing the adapter, which is developed by [Weilong Guo](http://bioinfo.au.tsinghua.edu.cn/member/wguo/index.html).\r\n\r\n    First, if the adapter was provided as \"AGATCGGAAGAGCACACGTC\", only the first 10bp would be used.\r\n    Second, we use semi-local alignment strategy for removing the adapters.\r\n    Exmaple:\r\n\r\n        Read :       ACCGCGTTGATCGAGTACGTACGTGGGTC\r\n        Adapter :    ....................ACGTGGGTCCCG\r\n\r\n        no_mismatch : the maximum number allowed for mismatches\r\n\r\n        Algorithm: (allowing 1 mismatch)\r\n        -Step 1:\r\n          ACCGCGTTGATCGAGTACGTACGTGGGTC\r\n          ||XX\r\n          ACGTGGGTCCCG\r\n        -Step 2:\r\n          ACCGCGTTGATCGAGTACGTACGTGGGTC\r\n           X||X\r\n          .ACGTGGGTCCCG\r\n        -Step 3:\r\n          ACCGCGTTGATCGAGTACGTACGTGGGTC\r\n            XX\r\n          ..ACGTGGGTCCCG\r\n        -Step ...\r\n        -Step N:\r\n          ACCGCGTTGATCGAGTACGTACGTGGGTC\r\n                              |||||||||\r\n          ....................ACGTGGGTCCCG\r\n        Success & return!\r\n\r\n    Third, we also removed the synthesized bases at the end of RRBS fragments.\r\n    Take the \"C-CGG\" cutting site as example,\r\n\r\n        - - C|U G G - - =>cut=> - - C      =>add=> - - C|C G =>sequencing\r\n        - - G G C|C - -         - - G G C          - - G G C\r\n\r\n    In our algorithm, the \"CG\" in \"--CCG\" (upper strand) was trimmed, in order to get accurate methylation level.\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}